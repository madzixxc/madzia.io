<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>madzia.io - Spermatozoid Spotlight (Mobile, No Heart)</title>
<style>
html, body {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  background: black;
  overflow: hidden;
}
.container {
  position: relative;
  width: 100%;
  height: 100%;
}
.text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 200px;
  font-weight: bold;
  color: white;
  pointer-events: none;
}
.worms-container {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
}
.worm {
  position: absolute;
  width: 0;
  height: 0;
}
.worm .head {
  position: absolute;
  width: 25px;
  height: 10px;
  border-radius: 50px;
  background: white;
  transform: translate(-50%, -50%);
}
.worm .tail {
  position: absolute;
  width: 10px;
  height: 3px;
  border-radius: 50%;
  background: white;
  left: -15px;
  top: 50%;
  transform: translate(-50%, -50%);
}
.spotlight {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  background: radial-gradient(circle at var(--spot-x, 50%) var(--spot-y, 50%), transparent 100px, black 120px);
  z-index: 10;
}
</style>
</head>
<body>
<div class="container">
  <div class="text">madzia.io</div>
  <div class="worms-container"></div>
  <div class="spotlight"></div>
</div>
<script>
var container = document.querySelector('.container');
var textEl = document.querySelector('.text');
var wormsContainer = document.querySelector('.worms-container');
var spotlight = document.querySelector('.spotlight');
var mouseX = window.innerWidth / 2, mouseY = window.innerHeight / 2;
var numWorms = 50;
var worms = [];
var attractForce = 0.45;
var repelForce = 2.7;
var damping = 0.9;
var textRect;
function updateTextRect() {
  textRect = textEl.getBoundingClientRect();
}
updateTextRect();
window.addEventListener('resize', function() {
  updateTextRect();
});
function getRandomBorderPoint(rect) {
  var w = rect.width, h = rect.height, p = Math.random() * (2 * (w + h));
  if (p < w) { return { x: rect.left + p, y: rect.top }; }
  else if (p < w + h) { return { x: rect.right, y: rect.top + (p - w) }; }
  else if (p < 2 * w + h) { return { x: rect.right - (p - w - h), y: rect.bottom }; }
  else { return { x: rect.left, y: rect.bottom - (p - 2 * w - h) }; }
}
function createWorm() {
  var wormEl = document.createElement('div');
  wormEl.className = 'worm';
  var headEl = document.createElement('div');
  headEl.className = 'head';
  var tailEl = document.createElement('div');
  tailEl.className = 'tail';
  wormEl.appendChild(headEl);
  wormEl.appendChild(tailEl);
  wormsContainer.appendChild(wormEl);
  var point = getRandomBorderPoint(textRect);
  return { el: wormEl, x: point.x, y: point.y, vx: 0, vy: 0, target: getRandomBorderPoint(textRect) };
}
for (var i = 0; i < numWorms; i++) {
  worms.push(createWorm());
}
function updateSpotlight(e) {
  var x = e.clientX || e.touches[0].clientX;
  var y = e.clientY || e.touches[0].clientY;
  mouseX = x;
  mouseY = y;
  spotlight.style.setProperty('--spot-x', x + 'px');
  spotlight.style.setProperty('--spot-y', y + 'px');
}
document.addEventListener('mousemove', updateSpotlight);
document.addEventListener('touchmove', function(e) {
  e.preventDefault();
  updateSpotlight(e);
}, { passive: false });
document.addEventListener('touchstart', updateSpotlight);
function update() {
  for (var i = 0; i < worms.length; i++) {
    var worm = worms[i];
    var dx = worm.target.x - worm.x, dy = worm.target.y - worm.y;
    var dist = Math.hypot(dx, dy);
    if (dist < 10) { worm.target = getRandomBorderPoint(textRect); }
    var ax = (dx / dist) * attractForce, ay = (dy / dist) * attractForce;
    var dxm = worm.x - mouseX, dym = worm.y - mouseY;
    var distMouse = Math.hypot(dxm, dym);
    if (distMouse < 100) {
      ax += (dxm / distMouse) * repelForce;
      ay += (dym / distMouse) * repelForce;
    }
    worm.vx = (worm.vx + ax) * damping;
    worm.vy = (worm.vy + ay) * damping;
    worm.x += worm.vx;
    worm.y += worm.vy;
    var angle = Math.atan2(worm.vy, worm.vx) * 180 / Math.PI;
    worm.el.style.left = worm.x + 'px';
    worm.el.style.top = worm.y + 'px';
    worm.el.style.transform = 'rotate(' + angle + 'deg)';
  }
  requestAnimationFrame(update);
}
update();
</script>
</body>
</html>
